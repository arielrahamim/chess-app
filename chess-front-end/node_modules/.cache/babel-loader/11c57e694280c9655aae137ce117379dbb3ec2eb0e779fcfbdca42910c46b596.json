{"ast":null,"code":"import _regeneratorRuntime from\"/home/mushrambo/projects/eks-chess/chess-front-end/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/mushrambo/projects/eks-chess/chess-front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/mushrambo/projects/eks-chess/chess-front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import React,{useContext,useEffect,useState}from'react';import{Alert,Spinner,Table}from'react-bootstrap';import{Link,useHistory}from'react-router-dom';import UserContext from'../../context/UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _require=require('../Utils/Config'),SERVER_URL=_require.SERVER_URL;function MatchHistory(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),validUser=_useState6[0],setValidUser=_useState6[1];var User=useContext(UserContext);var history=useHistory();useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var userId,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;// get the user id from parameters\nuserId=props.match.params.userId;_context.next=4;return axios.get(\"\".concat(SERVER_URL,\"/u/getUserWithMatches\"),{params:{userId:userId}});case 4:res=_context.sent;// data will be from first match to latest match. we want latest match first.\nres.data.matches.reverse();setUser(res.data);setIsLoading(false);setValidUser(true);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);setIsLoading(false);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[props.match.params.userId]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"Spinner\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"primary\"})});}if(!validUser){return/*#__PURE__*/_jsx(Alert,{variant:\"warning\",children:\"404 User Not Found\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"ul\",{className:\"nav nav-tabs\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{className:\"nav-link\",to:\"/u/\".concat(props.match.params.userId),children:\"View Profile\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{className:\"nav-link active profile-active-tab\",\"aria-current\":\"page\",to:\"/u/\".concat(props.match.params.userId,\"/matches\"),children:\"Match History\"})}),props.match.params.userId==User.user.id&&/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{className:\"nav-link\",to:\"/u/updateProfile\",children:\"Update Profile\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"nav-item\",children:/*#__PURE__*/_jsx(Link,{className:\"nav-link\",to:\"/u/\".concat(props.match.params.userId,\"/rating\"),children:\"User Rating\"})})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"match-history-container\",children:/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Index\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Opponent\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),User.user.id==props.match.params.userId&&/*#__PURE__*/_jsx(\"th\",{children:\"Goto Match\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:user.matches.map(function(match,index){var status='';if(match.winner===''){status='Not Finished';}else if(match.winner==='draw'){status='draw';}else{if(match.winner==='white'&&match.whitePlayer._id==props.match.params.userId||match.winner==='black'&&match.blackPlayer._id==props.match.params.userId){status='Won';}else{status='Lose';}}return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index}),/*#__PURE__*/_jsx(\"td\",{children:match.whitePlayer._id==props.match.params.userId?match.blackPlayer.username:match.whitePlayer.username}),/*#__PURE__*/_jsx(\"td\",{children:match.createdAt.substr(0,16).replace('T',' | ')}),/*#__PURE__*/_jsx(\"td\",{children:status}),User.user.id==props.match.params.userId&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark\",onClick:function onClick(){return history.push(\"/g/\".concat(match._id));},children:\"GO\"})})]},index);})})]})})]});}export default MatchHistory;","map":{"version":3,"names":["axios","React","useContext","useEffect","useState","Alert","Spinner","Table","Link","useHistory","UserContext","jsx","_jsx","jsxs","_jsxs","_require","require","SERVER_URL","MatchHistory","props","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","validUser","setValidUser","User","history","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userId","res","wrap","_callee$","_context","prev","next","match","params","get","concat","sent","data","matches","reverse","t0","stop","apply","arguments","className","children","animation","variant","to","id","striped","bordered","hover","map","index","status","winner","whitePlayer","_id","blackPlayer","username","createdAt","substr","replace","onClick","push"],"sources":["/home/mushrambo/projects/eks-chess/chess-front-end/src/components/User/MatchHistory.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Alert, Spinner, Table } from 'react-bootstrap';\nimport { Link, useHistory } from 'react-router-dom';\nimport UserContext from '../../context/UserContext';\nconst { SERVER_URL } = require('../Utils/Config');\n\nfunction MatchHistory(props) {\n    const [user, setUser] = useState({});\n    const [isLoading, setIsLoading] = useState(true);\n    const [validUser, setValidUser] = useState(false);\n\n    const User = useContext(UserContext);\n    const history = useHistory();\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                // get the user id from parameters\n                const userId = props.match.params.userId;\n                const res = await axios.get(`${SERVER_URL }/u/getUserWithMatches`, { params: { userId: userId } });\n                // data will be from first match to latest match. we want latest match first.\n                res.data.matches.reverse();\n                setUser(res.data);\n                setIsLoading(false);\n                setValidUser(true);\n            } catch (error) {\n                setIsLoading(false);\n            }\n        };\n        fetchData();\n    }, [props.match.params.userId]);\n\n    if (isLoading) {\n        return (\n            <div className='Spinner'>\n                <Spinner animation='border' variant='primary' />\n            </div>\n        );\n    }\n\n    if (!validUser) {\n        return <Alert variant='warning'>404 User Not Found</Alert>;\n    }\n\n    return (\n        <div className='profile-container'>\n            <div>\n                <ul className='nav nav-tabs'>\n                    <li className='nav-item'>\n                        <Link className='nav-link' to={`/u/${props.match.params.userId}`}>\n                            View Profile\n                        </Link>\n                    </li>\n                    <li className='nav-item'>\n                        <Link\n                            className='nav-link active profile-active-tab'\n                            aria-current='page'\n                            to={`/u/${props.match.params.userId}/matches`}>\n                            Match History\n                        </Link>\n                    </li>\n                    {props.match.params.userId == User.user.id && (\n                        <li className='nav-item'>\n                            <Link className='nav-link' to='/u/updateProfile'>\n                                Update Profile\n                            </Link>\n                        </li>\n                    )}\n                    <li className='nav-item'>\n                        <Link className='nav-link' to={`/u/${props.match.params.userId}/rating`}>\n                            User Rating\n                        </Link>\n                    </li>\n                </ul>\n            </div>\n            <div id='match-history-container'>\n                <Table striped bordered hover>\n                    <thead>\n                        <tr>\n                            <th>Index</th>\n                            <th>Opponent</th>\n                            <th>Time</th>\n                            <th>Status</th>\n                            {User.user.id == props.match.params.userId && <th>Goto Match</th>}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {user.matches.map((match, index) => {\n                            let status = '';\n                            if (match.winner === '') {\n                                status = 'Not Finished';\n                            } else if (match.winner === 'draw') {\n                                status = 'draw';\n                            } else {\n                                if (\n                                    (match.winner === 'white' && match.whitePlayer._id == props.match.params.userId) ||\n                                    (match.winner === 'black' && match.blackPlayer._id == props.match.params.userId)\n                                ) {\n                                    status = 'Won';\n                                } else {\n                                    status = 'Lose';\n                                }\n                            }\n                            return (\n                                <tr key={index}>\n                                    <td>{index}</td>\n                                    <td>\n                                        {match.whitePlayer._id == props.match.params.userId\n                                            ? match.blackPlayer.username\n                                            : match.whitePlayer.username}\n                                    </td>\n                                    <td>{match.createdAt.substr(0, 16).replace('T', ' | ')}</td>\n                                    <td>{status}</td>\n                                    {User.user.id == props.match.params.userId && (\n                                        <td>\n                                            <button className='btn btn-dark' onClick={() => history.push(`/g/${match._id}`)}>\n                                                GO\n                                            </button>\n                                        </td>\n                                    )}\n                                </tr>\n                            );\n                        })}\n                    </tbody>\n                </Table>\n            </div>\n        </div>\n    );\n}\n\nexport default MatchHistory;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}